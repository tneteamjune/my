{% extends 'layouts/default.html' %}
{% load pybo_filter %}
{% block content %}

<div class="container my-3">
    <a class="text-center">
        <h5>나의 제안하기</h5></a>
        <img src="/static/image/contact.png" alt = "my_contact" style=" max-width: 500px; height:auto; margin: 0.2rem; ">

        <table class="table">
            <thead>
            <tr class="text-center thead-dark">
                <th>번호</th>
                <th>제목</th>
                <th>내용</th>
                <th>첨부</th>
                <th>작성일시</th>
                <th>채택</th>
            </tr>
            </thead>
            <tbody>
                {% if contacts %}
                {% for contact in contacts %}
                <tr class="text-center">
                    <td class="text-left">{{ contact.id }}</td>
                    <td >{{ contact.subject }}</td>
                    <td>{{ contact.content }}</td>
                    {% if contact.imgs %}
                    <td><a href="{{contact.imgs.url}}"><img src="{{contact.imgs.url}}" height="50"></a></td>
                    {% else %}
                    <td>None</td>
                    {% endif %}
                    <td>{{ contact.create_date }}</td>
                    {% if contact.select == 0 %}
                    <td><button type="submit" class="btn btn-primary">채택대기</button></td>
                    {% elif contact.select == 1 %}
                    <td><form method="post" class="post-form" action="{% url 'common:contact_point' %}">
                        {% csrf_token %}
                        <input type="hidden" class="form-control" name="reason" id="reason"
                        value="{{ '제안 채택' |default_if_none:contact.id }}">
                        <input type="hidden" class="form-control" name="event" id="event"
                        value="{{ contact.id }}">
                        <button type="submit" class="btn btn-success">점수받기</button>
                    </form></td>
                    {% else %}
                    <td><button type="submit" class="btn btn-secondary">채택완료</button></td>
                    {% endif %}
                    </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="3">아직 나의 제안이 없어요.
                        <p>소중한 의견을 기다리고 있습니다.
                        <p><a href = '/common/contact'>제안하기</a>에 참여해주세요.
                    </td>
                </tr>
                {% endif %}
            </tbody>
        </table>
</div>

<form id="searchForm" method="get" action="{% url 'index' %}">
    <input type="hidden" id="kw" name="kw" value="{{ kw|default_if_none:'' }}">
    <input type="hidden" id="page" name="page" value="{{ page }}">
    <input type="hidden" id="so" name="so" value="{{ so }}">
</form>
{% endblock %}
